import{j as s}from"./ui-By_2Fhe3.js";import{u as F,e as I,r as l,L as p}from"./router-BpYP0_uS.js";import{l as Y,u as J,C as r,a as n,d as i,B as d,q as B,m as z,R as L,b as c,F as D,r as H,c as g,n as W,s as S,p as f,v as j,P as o,w as $,t as A}from"./index-Dm6eGH54.js";import{D as V,a as q,b as G,c as O,d as Z,e as Q}from"./dialog-BMqk2Aun.js";import{S as T}from"./StatusIndicator-CNj9OVFN.js";import{P as X}from"./ProgressBar-B2hb8ze0.js";import{f as K}from"./format-CI9fAwaI.js";import{C as x}from"./circle-check-big-Cj0iId1M.js";import"./vendor-9sitkZcQ.js";import"./status-Dw32TaKU.js";import"./clock-CnDSZUBK.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],es=Y("party-popper",ss);function us(){const{user:e,refreshUser:_}=J(),C=F(),[y]=I(),[h,N]=l.useState([]),[ts,b]=l.useState(null),[M,k]=l.useState(!0),[R,u]=l.useState(!1),[w,v]=l.useState(!1);l.useEffect(()=>{const t=y.get("payment_success"),a=localStorage.getItem("welcome_modal_shown");t==="true"&&!a&&(u(!0),localStorage.setItem("welcome_modal_shown","true"))},[y]),l.useEffect(()=>{(async()=>{try{const[a,P]=await Promise.all([S.getJobs().catch(U=>(f.debug("Jobs endpoint not available yet, using empty array"),[])),S.getUserUsage().catch(U=>(f.debug("Usage endpoint not available yet, using defaults"),{parses_this_month:e?.parsesThisMonth||0,monthly_limit:e?.monthlyLimit||o.STANDARD,remaining_parses:e?.monthlyLimit?e.monthlyLimit-(e.parsesThisMonth||0):o.STANDARD,usage_percentage:e?.monthlyLimit?(e.parsesThisMonth||0)/e.monthlyLimit*100:0,days_until_reset:j.DEFAULT_CYCLE_DAYS}))]);N(Array.isArray(a)?a.slice(0,$.MAX_RECENT_JOBS):[]);const m=P;b({parsesThisMonth:m?.parses_this_month||e?.parsesThisMonth||0,monthlyLimit:m?.monthly_limit||e?.monthlyLimit||o.STANDARD,remainingParses:m?.remaining_parses||(e?.monthlyLimit?e.monthlyLimit-(e.parsesThisMonth||0):o.STANDARD),usagePercentage:m?.usage_percentage||(e?.monthlyLimit?(e.parsesThisMonth||0)/e.monthlyLimit*100:0),daysUntilReset:m?.days_until_reset||j.DEFAULT_CYCLE_DAYS})}catch(a){f.error("Error fetching dashboard data:",a),N([]),b({parsesThisMonth:e?.parsesThisMonth||0,monthlyLimit:e?.monthlyLimit||o.STANDARD,remainingParses:e?.monthlyLimit?e.monthlyLimit-(e.parsesThisMonth||0):o.STANDARD,usagePercentage:e?.monthlyLimit?(e.parsesThisMonth||0)/e.monthlyLimit*100:0,daysUntilReset:j.DEFAULT_CYCLE_DAYS})}finally{k(!1)}})()},[e]),e&&e.monthlyLimit>0&&e.parsesThisMonth/e.monthlyLimit*100;const E=async()=>{v(!0);try{await _(),A.success("Subscription status updated successfully")}catch{A.error("Failed to refresh subscription status. Please try again.")}finally{v(!1)}};return M?s.jsx("div",{className:"space-y-6",children:s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((t,a)=>s.jsxs(r,{className:"animate-pulse",children:[s.jsx(n,{className:"pb-2",children:s.jsx("div",{className:"h-4 bg-muted rounded w-24"})}),s.jsx(i,{children:s.jsx("div",{className:"h-8 bg-muted rounded w-16"})})]},a))})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(V,{open:R,onOpenChange:u,children:s.jsxs(q,{className:"sm:max-w-md",children:[s.jsxs(G,{children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx(es,{className:"h-8 w-8 text-primary"})})}),s.jsx(O,{className:"text-center text-2xl",children:"Welcome to TidyFrame!"}),s.jsx(Z,{className:"text-center",children:"Your account is now active with 100,000 monthly parses. Let's process your first file!"})]}),s.jsxs("div",{className:"space-y-3 py-4",children:[s.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/50",children:[s.jsx(x,{className:"h-5 w-5 text-success mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:"95%+ Accuracy"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"AI-powered name parsing with entity detection"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/50",children:[s.jsx(x,{className:"h-5 w-5 text-success mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:"Lightning Fast"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Process 1000 names in under 1 minute"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/50",children:[s.jsx(x,{className:"h-5 w-5 text-success mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:"Easy Export"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Download results in CSV or Excel format"})]})]})]}),s.jsx(Q,{children:s.jsxs(d,{className:"w-full",size:"lg",onClick:()=>{u(!1),C("/dashboard/upload")},children:["Upload Your First File",s.jsx(B,{className:"ml-2 h-4 w-4"})]})})]})}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Welcome back",e?.fullName?`, ${e.fullName}`:"","!"]}),s.jsx("p",{className:"text-muted-foreground",children:"Here's what's happening with your name parsing projects today."})]}),e?.plan==="free"&&s.jsx(r,{className:"border-primary/50 bg-primary/5",children:s.jsx(i,{className:"pt-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(z,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Subscription Status"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"If you just completed payment, click refresh to update your subscription status."})]})]}),s.jsx(d,{variant:"outline",size:"sm",onClick:E,disabled:w,className:"flex-shrink-0",children:w?s.jsxs(s.Fragment,{children:[s.jsx(L,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(L,{className:"mr-2 h-4 w-4"}),"Refresh Status"]})})]})})}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[s.jsxs(r,{children:[s.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(c,{className:"text-sm font-medium",children:"Parses This Month"}),s.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(i,{children:[s.jsx("div",{className:"text-2xl font-bold",children:e?.parsesThisMonth||0}),s.jsxs("p",{className:"text-caption text-muted-foreground",children:["of ",e?.monthlyLimit===-1?"âˆž":e?.monthlyLimit||1e5," limit"]})]})]}),s.jsxs(r,{children:[s.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(c,{className:"text-sm font-medium",children:"Active Jobs"}),s.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(i,{children:[s.jsx("div",{className:"text-2xl font-bold",children:h.filter(t=>t.status==="processing"||t.status==="pending").length}),s.jsx("p",{className:"text-caption text-muted-foreground",children:"Currently processing"})]})]}),s.jsxs(r,{children:[s.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(c,{className:"text-sm font-medium",children:"Completed Today"}),s.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(i,{children:[s.jsx("div",{className:"text-2xl font-bold",children:h.filter(t=>t.status==="completed"&&new Date(t.completedAt).toDateString()===new Date().toDateString()).length}),s.jsx("p",{className:"text-caption text-muted-foreground",children:"Files processed"})]})]})]}),e&&e.monthlyLimit!==-1&&s.jsxs(r,{children:[s.jsxs(n,{children:[s.jsx(c,{children:"Monthly Usage"}),s.jsx(g,{children:"Your parsing usage for this billing period"})]}),s.jsx(i,{children:s.jsx(X,{value:e.parsesThisMonth,max:e.monthlyLimit,showLabel:!0,label:`Parses Used: ${e.parsesThisMonth} / ${e.monthlyLimit}`,dangerZone:80,size:"sm"})})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs(r,{children:[s.jsxs(n,{children:[s.jsx(c,{children:"Quick Actions"}),s.jsx(g,{children:"Get started with common tasks"})]}),s.jsxs(i,{className:"grid gap-2",children:[s.jsx(p,{to:"/dashboard/upload",children:s.jsxs(d,{className:"w-full justify-start",variant:"outline",children:[s.jsx(W,{className:"mr-2 h-4 w-4"}),"Upload New File"]})}),s.jsx(p,{to:"/dashboard/results",children:s.jsxs(d,{className:"w-full justify-start border border-info/20 hover:border-info/40",variant:"secondary",children:[s.jsx(D,{className:"mr-2 h-4 w-4"}),"View Results"]})})]})]}),s.jsxs(r,{children:[s.jsxs(n,{children:[s.jsx(c,{children:"Recent Jobs"}),s.jsx(g,{children:"Your latest file processing jobs"})]}),s.jsx(i,{children:h.length===0?s.jsx("p",{className:"text-muted-foreground text-sm",children:"No jobs yet. Upload your first file to get started!"}):s.jsxs("div",{className:"space-y-4",children:[h.map(t=>s.jsxs("div",{className:"flex items-center justify-between p-2 rounded border",role:"article","aria-label":`Job ${t.filename}, ${t.status}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(T,{status:t.status,mode:"icon",iconSize:"sm",animate:!0}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium truncate max-w-32",children:t.filename}),s.jsx("p",{className:"text-caption text-muted-foreground",children:K(t.createdAt)})]})]}),s.jsx(T,{status:t.status,mode:"badge"})]},t.id)),s.jsx(p,{to:"/dashboard/processing",children:s.jsx(d,{variant:"ghost",size:"sm",className:"w-full",children:"View All Jobs"})})]})})]})]})]})}export{us as default};
//# sourceMappingURL=DashboardHome-DIyuVBnL.js.map
