import{j as e}from"./ui-By_2Fhe3.js";import{u as p,e as h,r as i}from"./router-BpYP0_uS.js";import{u as f,C as y,a as j,i as u,b as v,c as N,d as w,p as t}from"./index-Dm6eGH54.js";import{C as b}from"./circle-check-big-Cj0iId1M.js";import"./vendor-9sitkZcQ.js";function A(){const a=p();h();const{user:n,refreshUser:d}=f(),[l,m]=i.useState(!0),[s,o]=i.useState(!1);return i.useEffect(()=>{(async()=>{try{if(n){t.debug("User already active, redirecting to dashboard"),o(!0),setTimeout(()=>{a("/dashboard/upload?payment_success=true",{replace:!0})},1500);return}const r=localStorage.getItem("pending_user"),x=localStorage.getItem("registration_complete");if(!r||!x){t.error("No pending user found, redirecting to login"),a("/auth/login",{replace:!0});return}const g=JSON.parse(r);if(t.debug("Activating pending user:",g.email),await new Promise(c=>setTimeout(c,1e3)),localStorage.getItem("token")){t.debug("Activating user with stored token");try{await d(),t.debug("User activated successfully")}catch(c){t.error("Failed to refresh user, continuing anyway:",c)}}localStorage.removeItem("pending_user"),localStorage.removeItem("registration_complete"),o(!0),m(!1),setTimeout(()=>{a("/dashboard/upload?payment_success=true",{replace:!0})},1500)}catch(r){t.error("Error activating user:",r),setTimeout(()=>{a("/dashboard?payment_success=true",{replace:!0})},2e3)}})()},[n,a]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background px-4",children:e.jsxs(y,{className:"w-full max-w-md",children:[e.jsxs(j,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:s?e.jsx(b,{className:"h-16 w-16 text-success animate-in zoom-in duration-500"}):e.jsx(u,{className:"h-16 w-16 text-primary animate-spin"})}),e.jsx(v,{className:"text-2xl font-bold",children:s?"Payment Successful!":"Processing Your Payment"}),e.jsx(N,{children:s?"Your account is now active. Redirecting you to start processing...":"Please wait while we activate your account..."})]}),e.jsxs(w,{className:"space-y-4 text-center",children:[!s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Thank you for subscribing to TidyFrame!"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"We're setting up your account with 100,000 monthly name parses."})]}),s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-success",children:"✓ Account activated"}),e.jsx("p",{className:"text-sm font-medium text-success",children:"✓ 100,000 monthly parses ready"}),e.jsx("p",{className:"text-sm font-medium text-success",children:"✓ Redirecting to upload..."})]}),l&&!s&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(u,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:"This may take a few seconds..."})]})]})]})})}export{A as default};
//# sourceMappingURL=PaymentSuccessPage-CE-ANech.js.map
